{"version":3,"sources":["webpack:///src/views/main/history/History.vue","webpack:///./src/views/main/history/History.vue?8263","webpack:///./src/views/main/history/History.vue"],"names":["History","name","components","EmptyView","ToolLoading","data","busy","page","recordStartNo","pageRecordNum","result","total","loading","watch","listData","handler","newVal","oldVal","length","start","end","this","addListener","removeListener","deep","computed","JSON","parse","stringify_default","methods","loadMore","scope","setTimeout","getHistory","docs","document","getElementsByClassName","i","child","children","addEventListener","index","newLink","keys_default","forEach","removeEventListener","destroy","resetQuery","param","Object","request","then","$response","_scope$result$data","push","apply","toConsumableArray_default","finally","routerData","$router","resolve","path","query","id","articleId","window","open","href","history_History","render","_vm","_h","$createElement","_c","_self","staticClass","directives","rawName","value","expression","attrs","infinite-scroll-disabled","infinite-scroll-distance","_l","item","key","timestamp","time","placement","domProps","innerHTML","_s","title","_v","description","_e","target","visibility-height","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/15.3f969a53f8342188c2bb.js","sourcesContent":["<template>\n    <div class='history'>\n        <el-timeline v-infinite-scroll='loadMore' infinite-scroll-disabled='busy' infinite-scroll-distance='10'>\n            <el-timeline-item :timestamp=\"item.time\" placement='top' v-for='(item, index) in result.data' :key=\"index\">\n                <el-card>\n                    <h3 v-html='item.title' class='history-title'></h3>\n                    <p v-html='item.description'></p>\n                </el-card>\n            </el-timeline-item>\n        </el-timeline>\n        <tool-loading :loading='loading' v-if='result.data.length === 0'></tool-loading>\n        <empty-view v-if='result.data.length === 0'></empty-view>\n        <el-backtop target='.history' :visibility-height='50'></el-backtop>\n    </div>\n</template>\n\n<script>\n    import {getHistoryInfo} from '../../../service/request';\n    import ToolLoading from '../../../components/util/ToolLoading';\n    import EmptyView from '../../../components/util/EmptyView';\n\n    export default {\n        name: 'History',\n        components: {EmptyView, ToolLoading},\n        data () {\n            return {\n                // 是否继续查询\n                busy: false,\n                // 分页信息\n                page: {\n                    recordStartNo: -1,\n                    pageRecordNum: 10\n                },\n                // 返回的数据\n                result: {\n                    data: [],\n                    total: 0\n                },\n                loading: false\n            };\n        },\n        watch: {\n            listData: {\n                handler (newVal, oldVal) {\n                    let scope = this;\n                    // 监听result.data的变化， 每次变化 重新绑定事件\n                    if (newVal.length > oldVal.length) {\n                        // 增加数据直接绑定\n                        let start = oldVal.length;\n                        let end = newVal.length - 1;\n                        scope.addListener(start, end);\n                    } else {\n                        // 清空数据 取消绑定\n                        scope.removeListener();\n                    }\n                },\n                deep: true\n            }\n        },\n        computed: {\n            listData () {\n                let scope = this;\n                return JSON.parse(JSON.stringify(scope.result.data));\n            }\n        },\n        methods: {\n            loadMore () {\n                let scope = this;\n                scope.busy = true;\n                scope.loading = true;\n                setTimeout(() => {\n                    scope.page.recordStartNo++;\n                    scope.getHistory();\n                }, 500);\n            },\n            addListener (start, end) {\n                let scope = this;\n                setTimeout(() => {\n                    let docs = document.getElementsByClassName('history-title');\n                    for (let i = start; i <= end; i++) {\n                        let child = docs[i].children[2];\n                        if (child) {\n                            child.addEventListener('click', (function (index) {\n                                return function () {\n                                    scope.newLink(index);\n                                };\n                            })(i), false);\n                        }\n                    }\n                }, 1000);\n            },\n            removeListener () {\n                let scope = this;\n                let docs = document.getElementsByClassName('history-title');\n                Object.keys(docs).forEach(index => {\n                    let child = docs[index].children[2];\n                    if (child) {\n                        child.removeEventListener('click', (function (index) {\n                            return function () {\n                                scope.newLink(index);\n                            };\n                        })(index), false);\n                    }\n                });\n            },\n            destroy () {\n                let scope = this;\n                scope.page = {\n                    recordStartNo: -1,\n                    pageRecordNum: 10\n                };\n                scope.result = {\n                    data: [],\n                    total: 0\n                };\n                scope.busy = false;\n            },\n            resetQuery () {\n                let scope = this;\n                scope.page = {\n                    recordStartNo: -1,\n                    pageRecordNum: 10\n                };\n                scope.result = {\n                    data: [],\n                    total: 0\n                };\n                scope.busy = false;\n                scope.loadMore();\n            },\n            getHistory () {\n                let scope = this;\n                let param = {\n                    recordStartNo: scope.page.recordStartNo,\n                    pageRecordNum: scope.page.pageRecordNum\n                };\n                getHistoryInfo(param).then(data => {\n                    scope.$response(data, 'infiniteScroll').then(data => {\n                        scope.result.total = data.total;\n                        if (data.data.length > 0) {\n                            scope.result.data.push(...data.data);\n                            scope.busy = false;\n                        } else {\n                            scope.busy = true;\n                        }\n                    });\n                }).finally(() => {\n                    scope.loading = false;\n                });\n            },\n            newLink (index) {\n                let scope = this;\n                let routerData = scope.$router.resolve({\n                    path: '/detail',\n                    query: {\n                        id: scope.result.data[index].articleId\n                    }\n                });\n                window.open(routerData.href, '_blank');\n                scope.resetQuery();\n            }\n        }\n    };\n</script>\n\n<style lang=\"scss\">\n    .history {\n        width: 100%;\n        height: 100%;\n        overflow: auto;\n\n        .el-timeline {\n            padding: .2rem 25rem;\n            box-sizing: border-box;\n\n            .el-timeline-item {\n                .el-timeline-item__timestamp {\n                    text-align: left;\n                }\n\n                .el-timeline-item__content {\n                    .history-title {\n                        span:nth-child(1) {\n                            color: #417BF1;\n                        }\n\n                        span:nth-child(3) {\n                            font-weight: 500;\n                            cursor: pointer;\n\n                            &:hover {\n                                color: #417BF1;\n                                text-decoration: underline;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n\n        // 修改滚动条样式\n        &::-webkit-scrollbar {\n            width: 10px;\n            height: 15px;\n        }\n\n        &::-webkit-scrollbar-track {\n            background-color: white;\n            border-radius: 2px;\n        }\n\n        &::-webkit-scrollbar-thumb {\n            background: #bfbfbf;\n            border-radius: 10px;\n\n            &:hover {\n                background: #a5a5a5;\n            }\n        }\n    }\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/main/history/History.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"history\"},[_c('el-timeline',{directives:[{name:\"infinite-scroll\",rawName:\"v-infinite-scroll\",value:(_vm.loadMore),expression:\"loadMore\"}],attrs:{\"infinite-scroll-disabled\":\"busy\",\"infinite-scroll-distance\":\"10\"}},_vm._l((_vm.result.data),function(item,index){return _c('el-timeline-item',{key:index,attrs:{\"timestamp\":item.time,\"placement\":\"top\"}},[_c('el-card',[_c('h3',{staticClass:\"history-title\",domProps:{\"innerHTML\":_vm._s(item.title)}}),_vm._v(\" \"),_c('p',{domProps:{\"innerHTML\":_vm._s(item.description)}})])],1)}),1),_vm._v(\" \"),(_vm.result.data.length === 0)?_c('tool-loading',{attrs:{\"loading\":_vm.loading}}):_vm._e(),_vm._v(\" \"),(_vm.result.data.length === 0)?_c('empty-view'):_vm._e(),_vm._v(\" \"),_c('el-backtop',{attrs:{\"target\":\".history\",\"visibility-height\":50}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-831ed6cc\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/main/history/History.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-831ed6cc\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./History.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./History.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./History.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-831ed6cc\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./History.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/main/history/History.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}
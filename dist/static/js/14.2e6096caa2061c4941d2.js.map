{"version":3,"sources":["webpack:///src/views/main/history/History.vue","webpack:///./src/views/main/history/History.vue?7cd3","webpack:///./src/views/main/history/History.vue"],"names":["History","name","components","EmptyView","ToolLoading","data","busy","page","recordStartNo","pageRecordNum","result","total","loading","watch","listData","handler","newVal","oldVal","length","start","end","this","addListener","removeListener","deep","computed","JSON","parse","stringify_default","methods","loadMore","scope","setTimeout","getHistory","docs","document","getElementsByClassName","i","child","children","addEventListener","index","newLink","keys_default","forEach","removeEventListener","destroy","resetQuery","param","Object","request","then","$response","_scope$result$data","push","apply","toConsumableArray_default","finally","routerData","$router","resolve","path","query","id","articleId","window","open","href","history_History","render","_vm","_h","$createElement","_c","_self","staticClass","directives","rawName","value","expression","attrs","infinite-scroll-disabled","infinite-scroll-distance","_l","item","key","timestamp","time","placement","domProps","innerHTML","_s","title","_v","description","_e","target","visibility-height","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/14.2e6096caa2061c4941d2.js","sourcesContent":["<template>\r\n    <div class='history'>\r\n        <el-timeline v-infinite-scroll='loadMore' infinite-scroll-disabled='busy' infinite-scroll-distance='10'>\r\n            <el-timeline-item :timestamp=\"item.time\" placement='top' v-for='(item, index) in result.data' :key=\"index\">\r\n                <el-card>\r\n                    <h3 v-html='item.title' class='history-title'></h3>\r\n                    <p v-html='item.description'></p>\r\n                </el-card>\r\n            </el-timeline-item>\r\n        </el-timeline>\r\n        <tool-loading :loading='loading' v-if='result.data.length === 0'></tool-loading>\r\n        <empty-view v-if='result.data.length === 0'></empty-view>\r\n        <el-backtop target='.history' :visibility-height='50'></el-backtop>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import {getHistoryInfo} from '../../../service/request';\r\n    import ToolLoading from '../../../components/util/ToolLoading';\r\n    import EmptyView from '../../../components/util/EmptyView';\r\n\r\n    export default {\r\n        name: 'History',\r\n        components: {EmptyView, ToolLoading},\r\n        data () {\r\n            return {\r\n                // 是否继续查询\r\n                busy: false,\r\n                // 分页信息\r\n                page: {\r\n                    recordStartNo: -1,\r\n                    pageRecordNum: 10\r\n                },\r\n                // 返回的数据\r\n                result: {\r\n                    data: [],\r\n                    total: 0\r\n                },\r\n                loading: false\r\n            };\r\n        },\r\n        watch: {\r\n            listData: {\r\n                handler (newVal, oldVal) {\r\n                    let scope = this;\r\n                    // 监听result.data的变化， 每次变化 重新绑定事件\r\n                    if (newVal.length > oldVal.length) {\r\n                        // 增加数据直接绑定\r\n                        let start = oldVal.length;\r\n                        let end = newVal.length - 1;\r\n                        scope.addListener(start, end);\r\n                    } else {\r\n                        // 清空数据 取消绑定\r\n                        scope.removeListener();\r\n                    }\r\n                },\r\n                deep: true\r\n            }\r\n        },\r\n        computed: {\r\n            listData () {\r\n                let scope = this;\r\n                return JSON.parse(JSON.stringify(scope.result.data));\r\n            }\r\n        },\r\n        methods: {\r\n            loadMore () {\r\n                let scope = this;\r\n                scope.busy = true;\r\n                scope.loading = true;\r\n                setTimeout(() => {\r\n                    scope.page.recordStartNo++;\r\n                    scope.getHistory();\r\n                }, 500);\r\n            },\r\n            addListener (start, end) {\r\n                let scope = this;\r\n                setTimeout(() => {\r\n                    let docs = document.getElementsByClassName('history-title');\r\n                    for (let i = start; i <= end; i++) {\r\n                        let child = docs[i].children[2];\r\n                        if (child) {\r\n                            child.addEventListener('click', (function (index) {\r\n                                return function () {\r\n                                    scope.newLink(index);\r\n                                };\r\n                            })(i), false);\r\n                        }\r\n                    }\r\n                }, 1000);\r\n            },\r\n            removeListener () {\r\n                let scope = this;\r\n                let docs = document.getElementsByClassName('history-title');\r\n                Object.keys(docs).forEach(index => {\r\n                    let child = docs[index].children[2];\r\n                    if (child) {\r\n                        child.removeEventListener('click', (function (index) {\r\n                            return function () {\r\n                                scope.newLink(index);\r\n                            };\r\n                        })(index), false);\r\n                    }\r\n                });\r\n            },\r\n            destroy () {\r\n                let scope = this;\r\n                scope.page = {\r\n                    recordStartNo: -1,\r\n                    pageRecordNum: 10\r\n                };\r\n                scope.result = {\r\n                    data: [],\r\n                    total: 0\r\n                };\r\n                scope.busy = false;\r\n            },\r\n            resetQuery () {\r\n                let scope = this;\r\n                scope.page = {\r\n                    recordStartNo: -1,\r\n                    pageRecordNum: 10\r\n                };\r\n                scope.result = {\r\n                    data: [],\r\n                    total: 0\r\n                };\r\n                scope.busy = false;\r\n                scope.loadMore();\r\n            },\r\n            getHistory () {\r\n                let scope = this;\r\n                let param = {\r\n                    recordStartNo: scope.page.recordStartNo,\r\n                    pageRecordNum: scope.page.pageRecordNum\r\n                };\r\n                getHistoryInfo(param).then(data => {\r\n                    scope.$response(data, 'infiniteScroll').then(data => {\r\n                        scope.result.total = data.total;\r\n                        if (data.data.length > 0) {\r\n                            scope.result.data.push(...data.data);\r\n                            scope.busy = false;\r\n                        } else {\r\n                            scope.busy = true;\r\n                        }\r\n                    });\r\n                }).finally(() => {\r\n                    scope.loading = false;\r\n                });\r\n            },\r\n            newLink (index) {\r\n                let scope = this;\r\n                let routerData = scope.$router.resolve({\r\n                    path: '/detail',\r\n                    query: {\r\n                        id: scope.result.data[index].articleId\r\n                    }\r\n                });\r\n                window.open(routerData.href, '_blank');\r\n                scope.resetQuery();\r\n            }\r\n        }\r\n    };\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n    .history {\r\n        width: 100%;\r\n        height: 100%;\r\n        overflow: auto;\r\n\r\n        .el-timeline {\r\n            padding: .2rem 25rem;\r\n            box-sizing: border-box;\r\n\r\n            .el-timeline-item {\r\n                .el-timeline-item__timestamp {\r\n                    text-align: left;\r\n                }\r\n\r\n                .el-timeline-item__content {\r\n                    .history-title {\r\n                        span:nth-child(1) {\r\n                            color: #417BF1;\r\n                        }\r\n\r\n                        span:nth-child(3) {\r\n                            font-weight: 500;\r\n                            cursor: pointer;\r\n\r\n                            &:hover {\r\n                                color: #417BF1;\r\n                                text-decoration: underline;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // 修改滚动条样式\r\n        &::-webkit-scrollbar {\r\n            width: 10px;\r\n            height: 15px;\r\n        }\r\n\r\n        &::-webkit-scrollbar-track {\r\n            background-color: white;\r\n            border-radius: 2px;\r\n        }\r\n\r\n        &::-webkit-scrollbar-thumb {\r\n            background: #bfbfbf;\r\n            border-radius: 10px;\r\n\r\n            &:hover {\r\n                background: #a5a5a5;\r\n            }\r\n        }\r\n    }\r\n\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/main/history/History.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"history\"},[_c('el-timeline',{directives:[{name:\"infinite-scroll\",rawName:\"v-infinite-scroll\",value:(_vm.loadMore),expression:\"loadMore\"}],attrs:{\"infinite-scroll-disabled\":\"busy\",\"infinite-scroll-distance\":\"10\"}},_vm._l((_vm.result.data),function(item,index){return _c('el-timeline-item',{key:index,attrs:{\"timestamp\":item.time,\"placement\":\"top\"}},[_c('el-card',[_c('h3',{staticClass:\"history-title\",domProps:{\"innerHTML\":_vm._s(item.title)}}),_vm._v(\" \"),_c('p',{domProps:{\"innerHTML\":_vm._s(item.description)}})])],1)}),1),_vm._v(\" \"),(_vm.result.data.length === 0)?_c('tool-loading',{attrs:{\"loading\":_vm.loading}}):_vm._e(),_vm._v(\" \"),(_vm.result.data.length === 0)?_c('empty-view'):_vm._e(),_vm._v(\" \"),_c('el-backtop',{attrs:{\"target\":\".history\",\"visibility-height\":50}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-85228148\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/main/history/History.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-85228148\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./History.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./History.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./History.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-85228148\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./History.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/main/history/History.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}